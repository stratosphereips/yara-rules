rule linux_backdoor_godlua {
  meta:
    author      = "@_lubiedo"
    date        = "2020-09-03"
    description = "Linux/Godlua backdoor"
    malver      = "201811051556"
  strings:
    // hardcoded strings
    $s0   = "User-Agent: Mozilla/5.0 (compatible; Baiduspider/2.0;+http://www.baidu.com/search/spider.html"
    $s1   = "/usr/sbin/sshd"
    $s2   = "C:\\windows\\"
    $s3   = "C:\\RECYCLER\\"
    $s4   = "D:\\RECYCLER\\"
    $s5   = "C:\\windows\\temp\\"
    $s6   = "%sflash.bat"
    $s7   = "d.heheda.tk"

    // c2
    $op0		= { c7 44 24 0d 68 74 74 70 }
    $op1		= { c7 44 24 11 73 3a 2f 2f }
    $op2		= { c7 44 24 15 61 70 69 2e }
    $op3		= { c7 44 24 19 67 69 74 68 }
    $op4		= { c7 44 24 1d 75 62 2e 63 }
    $op5		= { c7 44 24 21 6f 6d 2f 72 }
    $op6		= { c7 44 24 25 65 70 6f 73 }
    $op7		= { c7 44 24 29 2f 68 65 6c }
    $op8		= { c7 44 24 2d 65 67 65 64 }
    $op9		= { c7 44 24 31 61 64 61 2f }
    $op10		= { c7 44 24 35 68 65 69 68 }

  condition:
    uint32be(0x0) == 0x7f454c46 //\x7fELF
      and all of them
}
