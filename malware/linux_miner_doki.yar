rule linux_miner_doki {
  meta:
    author      = "@_lubiedo"
    description = "Doki Miner"
    reference0  = "https://www.intezer.com/container-security/watch-your-containers-doki-infecting-docker-servers-in-the-cloud/"
    hash0       = "4aadb47706f0fe1734ee514e79c93eed65e1a0a9f61b63f3e7b6367bd9a3e63b"
    date        = "2020-07-31"

  strings:
    $s0   = "/api/v1/address/sent/DP9S4V3TeqRES3Zp7dmD7frAsNExCFKCbx"
    $s1   = "dogechain.info"
    $s2   = "cfltwf\n"
    $s3   = "update.sh"
    $s4   = { 2e 64 64 6e 73 2e 6e 65 } // .ddns.ne

  condition:
    uint32(0) == 0x464c457f and filesize < 1MB and all of them
}
