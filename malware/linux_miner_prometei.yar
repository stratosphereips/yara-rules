import "elf"

rule linux_miner_prometei
{
  meta:
    author      = "@_lubiedo"
    date        = "2021-03-10"
    description = "Prometei"
    hash        = "0302c22471c7da7a4cfd9ef3cb1e35decd8670ee0c00f3f4714b2e918008f4bf"

  strings:
      $s00  = "/proc/%d/exe"
        $s01  = "start_mining"
        $s02  = "stop_mining"
        $s03  = { 32 61 68 73 } // sha1
        $s04  = { 65 67 77 78 74 } // xwget
        $s05  = "CommId"
        
        $url  = "/prometei.cgi" nocase
  condition:
      elf.type == elf.ET_EXEC and filesize < 100KB and $url and 3 of ($s*)
}
