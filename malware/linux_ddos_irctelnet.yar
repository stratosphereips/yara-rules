rule linux_ddos_irctelnet
{
    meta:
    author      = "@_lubiedo"
    date        = "2020-08-25"
    description = "IRCTelnet/New Aidra DDoS botnet"

    strings:
        // special strings
        $str0 = "%x:%x:%x:%x:%x:%x:%x:%x"
        $str1 = "/etc/firewall_stop"
        $str2 = "%d.%d.0.0" 
        $str3 = "rm -f %s/*" 
        $str4 = "USER %s . . : ." 

        $attack0 = "fin.ack.psh"
        $attack1 = "ack.psh.rst"
        $attack2 = "ack.psh.urg"
        $attack3 = "fin.psh"
        $attack4 = "fin.ack"
        $attack5 = "syn.ack"
        $attack6 = "ack.psh"
        $attack7 = "ack.rst"
        
    condition:
        ( uint32(0) == 0x464c457f and filesize < 1MB ) and 3 of ($str*)
            and any of ($attack*)
}
